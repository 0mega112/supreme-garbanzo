<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fyber Profile</title>
    <link rel="stylesheet" href="profile.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body class="profile-page">

    <div class="page-container">
        
        <header class="page-header">
            <h1 class="page-title">Профиль</h1>
        </header>

        <div class="card user-info-card">
            <div class="avatar-box">
                    <img src="images/user.png" alt="User" class="avatar-img">
                </div>

            <div class="info-container">
                <h2 class="username" id="display-username">LOADING...</h2>
                <p class="user-id">ID: <span id="display-id">...</span></p>
                <button class="copy-btn" onclick="copyToClipboard()">
                    Скопировать ID
                </button>
            </div>
        </div>

        <div class="menu-list">
            
            <a href="#" class="menu-card" onclick="openTgLink('https://t.me/TEAM_FYBER'); return false;">
                <div class="menu-text">
                    Главный<br>Менеджер
                </div>
                <img src="images/profile_manager.png" alt="Manager" class="menu-floating-img1">
            </a>

            <a href="#" class="menu-card" onclick="openTgLink('https://t.me/reviewsFYBER'); return false;">
                <div class="menu-text">
                    Группа<br>Отзывов
                </div>
                <img src="images/profile_reviews.png" alt="Reviews" class="menu-floating-img2">
            </a>

            <a href="#" class="menu-card" onclick="openTgLink('https://t.me/profitsFYBER'); return false;">
                <div class="menu-text">
                    Группа<br>Профитов
                </div>
                <img src="images/profile_profits.png" alt="Profits" class="menu-floating-img3">
            </a>

        </div>

    </div>

    <nav class="bottom-nav">
        <a href="dashboard.html" class="nav-item">
            <img src="images/dashboard.png" alt="Menu" class="nav-icon">
        </a>

        <a href="balance.html" class="nav-item">
            <img src="images/balance.png" alt="Balance" class="nav-icon">
        </a>

        <a href="#" class="nav-item active">
            <img src="images/profile_white.png" alt="Profile" class="nav-icon">
            <span>Профиль</span>
        </a>
    </nav>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Load data from LocalStorage
            const savedID = localStorage.getItem("fyber_current_id");
            const savedName = localStorage.getItem("fyber_nickname");

            if (savedID) document.getElementById('display-id').textContent = savedID;
            if (savedName) document.getElementById('display-username').textContent = savedName;
            
            // Expand app just in case
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.expand();
            }

            // ======================================================
            // UPDATED NAVIGATION LOGIC (Paste this into script section)
            // ======================================================
            const navItems = document.querySelectorAll('.nav-item');

            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    const href = item.getAttribute('href');
                    
                    // Check if it is a valid link to a different page
                    if (href && href !== '#' && !item.classList.contains('active')) {
                        e.preventDefault(); // Stop instant reload
                        
                        // 1. Animate the Bottom Pill (Visual Swap)
                        document.querySelector('.nav-item.active')?.classList.remove('active');
                        item.classList.add('active');
                        
                        // 2. Animate the Whole Page (Fade Out)
                        document.body.classList.add('fade-out');
                        
                        // 3. Wait 350ms for animations to finish, THEN go to next page
                        setTimeout(() => {
                            window.location.href = href;
                        }, 350);
                    }
                });
            });
        });

        // --- NEW: FUNCTION TO OPEN TELEGRAM LINKS NATIVELY ---
        function openTgLink(url) {
            if (window.Telegram && window.Telegram.WebApp) {
                // This opens the chat instantly inside Telegram
                window.Telegram.WebApp.openTelegramLink(url);
            } else {
                // Fallback for browser testing
                window.location.href = url;
            }
        }

        // Copy ID Logic
        function copyToClipboard() {
            const idText = document.getElementById('display-id').textContent;
            navigator.clipboard.writeText(idText).then(() => {
                const btn = document.querySelector('.copy-btn');
                const originalText = btn.textContent;
                
                btn.textContent = "Скопировано!";
                btn.style.color = "#2ecc71";
                btn.style.borderColor = "#2ecc71";
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.color = "#6e7f75";
                    btn.style.borderColor = "#1f3a2d";
                }, 2000);
            });
        }
    </script>
</body>
</html>
